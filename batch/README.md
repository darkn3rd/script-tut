# Scripting Tutorial: BATCH (Command Shell)

Â© Joaquin Menchaca, 2014

Version 1.1

## Overview

This covers the Windows Command Shell, sometimes referred to as BATCH due to the similarity with historical DOS operating system.  Windows Command Shell scripts will end with the ```.CMD``` extension, but the environment will also execute scripts with the ```.BAT``` extension as well.  The scripts in this section only work with Windows Command Shell found in flavors of Windows NT.

## History

The *BATCH* environment has existed since 1981 with the releases of MS-DOS, IBM PC-DOS, and DR-DOS (Digital Research). Different versions of Windows 4.x (a.k.a. Windows '95 to Windows ME) were bundled with MS-DOS, and thus by nature included the the *BATCH* environment.

A new environment, called *Command Shell*, was introduced with the with IBM OS/2, and later with Microsoft Windows NT.  Future versions of Windows NT, marketed as Windows XP, Windows 7, Windows 8, and so forth, continue to carry the *Command Shell*.

## Historical Alternatives to Batch

The original BATCH environment was extremely limited, and was extended in a variety of ways.  In MS-DOS, many were able to compile small Assembly language scripts using ```DEBUG```, and with MS-DOS 5.0, Basic scripts using  ```QBASIC /RUN```, and in PC-DOS, there was the REXX scripting environment.  REXX was popular on mainframes and Amiga OS.  An alternative third party called 4DOS was quite popular, as well as MKS Tools, which provided Korn Shell capability to DOS. The toolset DGJPP (http://www.delorie.com/djgpp/) provided UNIX tools to DOS.  

Today, Command Shell has added features beyond its earlier BATCH cousin, but it is still quite limited.  For any heavy lifting, Microsoft has provided WSH (Windows Scripting Host) with support for languages like VBScript and JScript (JavaScript) for scripting the environment.  Also popular were languages like Perl, Python, Ruby, and KiXart (http://www.kixtart.org/).  Today, especially after Windows 2008, PowerShell has become the one ubiquitous language for modern Windows operating systems, but still the Command Shell remains popular for basic chores.

## Testing

* Windows NT 6.1 (Windows 7)

## Lessons

This is a subset of lessons for Batch (Command Shell):

* :books: Output
  * :green_book: Standard Output [A00]
* :books: Variables
  * :green_book: String Concatenation [B00]
* :books: Arithmetic
  * :green_book: Basic Arithmetic [C00]
  * :closed_book: Boolean Logic [C11]
* :books: Input
  * :green_book: Reading a Line [D00]
* :books: Branching
  * :green_book: Branch on Number Range [E20]
  * :closed_book: Branch on String Pattern
    * :page_facing_up: Character Sets [E61]
* :books: Looping
  * :green_book: Collection Loop
    * :page_facing_up: Conditional Loop test directory listing [F00]
  * :green_book: Count Loop
      * :page_facing_up: Loop with `for in do ()` [F10]
  * :closed_book: Conditional Loop
      * :page_facing_up: Loop with `do...while()` [F21]
* :books: Sub-Routines
  * :closed_book: Creation and Calling [I01]
* :books: Arguments from the Command Line
  * :green_book: Usage Statement (Script Name and Arg Count) [J00]
  * :green_book: Enumerate Arguments in Order [J10]
* :books: Exit
  * :green_book: Returning an Exit Status Code [L00]

**Key**
  :books: - topic area
* :green_book: - Lesson supported by language
* :closed_book: - Not supported by language, but alternative
* :page_facing_up: - Alternative methods to do the lesson

## Notes

### Details

This covers notes regarding each section.

1. Output
   * demonstrate escaping characters with carrot ```^``` character
2. Variables
3. Arithmetic
4. Input
5. Branch
   * IF on number
   * case statements **OMITTED** *Does not exist in Command Shell.*
   * IF on single character
     * Uses external command ```FINDSTR``` to match string pattern.  Note that regular expressions in ```FINDSTR``` cannot distinguish between uppercase and lowercase characters, so ```[a-z]``` is the same as ```[A-Z]```.
6. Looping
   * count loop
      * example: 10 to 1
   * conditional loops
      * *Note:* Simulated with ```GOTO``` statements
   * collection loop
      * iterate through set of items generated by subshell with ```FOR ... IN (` ... `) DO ( ... )``` structure
      * example: directory listing
9. Subroutine
   * **NOTE** *Utilizes ```CALL``` and ```GOTO``` for this type of functionality.*
10. Arguments
    * Print all arguments
      * *Note:* Simulated with ```GOTO``` statements as ```SHIFT``` doesn't work in ```FOR``` loops

### Omitted Lessons Due to Lack of Functionality

7. Arrays
   * **OMITTED** *Does not exist in Command Shell.*
8. Associative Arrays
   * **OMMITTED** *Does not existing Command Shell.*
11. Parameters
    * **OMITTED** *Does not exist in Command Shell.*
12. Function
    * **OMITTED** *Does not exist in Command Shell.*
